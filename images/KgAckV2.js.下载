var KgAck=KgAck||{$:function(){var els=[];for(var i=0,l=arguments.length;i<l;i++){var el=arguments[i];if(typeof el=="string"){el=document.getElementById(el)}if(l==1){return el}els.push(el)}return els},$T:function(tagName,el){var els=(this.$(el)||document).getElementsByTagName(tagName||"*");return this.$A(els)},$A:function(args){var arr=[];for(var i=0,l=args.length;i<l;i++){arr.push(args[i])}return arr},$C:function(name,el,tagName){var cEls=[],i=0;if(!!document.getElementsByClassName){var arr=this.$(el||document).getElementsByClassName(name);arr=this.$A(arr);if(tagName&&tagName!=="*"){for(var l=arr.length;i<l;i++){(arr[i].tagName.toLowerCase()===tagName.toLowerCase())&&cEls.push(arr[i])}}else{cEls=arr}}else{for(var arr=this.$T(tagName,el),l=arr.length;i<l;i++){new RegExp("\\b"+name+"\\b","g").test(arr[i].className)&&cEls.push(arr[i])}}return cEls},loadScript:function(url,args,callback,async){var params=args||"";if(args&&(typeof args==="object")){var str="";for(var i in args){str+=i+"="+args[i]+"&"}params=str.substr(0,str.length-1)}var script=document.createElement("script");script.type="text/javascript";if(params!=null&&params!=""){url=url+"?"+(params||"")}script.src=url;if(async==true){script.async="async"}script.onload=script.onreadystatechange=function(){if(!this.readyState||(this.readyState=="complete"||this.readyState=="loaded")){callback&&callback();script.onreadystatechange=script.onload=null;script=null}};document.getElementsByTagName("head")[0].appendChild(script)},JSON:function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value,whitelist){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}if(typeof value.toJSON==="function"){return stringify(value.toJSON())}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i],whitelist)||"null")}return"["+a.join(",")+"]"}if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}else{for(k in value){if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==="object"){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined){v[i]=n}else{delete v[i]}}}}return filter(k,v)}if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof filter==="function"?walk("",j):j}throw new SyntaxError("parseJSON")}}},Cookie:{write:function(name,value,exp,path,domain,secure){var expires="";if(exp){var dt=new Date();dt.setTime(dt.getTime()+(exp*1000));expires=";expires="+dt.toGMTString()}value=encodeURIComponent(value);path=path?"; path="+(path):";path=/";domain=domain?"; domain="+(domain):"";secure=secure?"; secure":"";document.cookie=[name,"=",value,expires,path,domain,secure].join("")},setDay:function(name,value,exp,path,domain,secure){this.write(name,value,(exp*24*60*60),path,domain,secure)},setHour:function(name,value,exp,path,domain,secure){this.write(name,value,(exp*60*60),path,domain,secure)},setMin:function(name,value,exp,path,domain,secure){this.write(name,value,(exp*60),path,domain,secure)},setSec:function(name,value,exp,path,domain,secure){this.write(name,value,(exp),path,domain,secure)},read:function(name,subName){var cookieValue="";var search=name+"=";if(document.cookie.length>0){offset=document.cookie.indexOf(search);if(offset!=-1){offset+=search.length;end=document.cookie.indexOf(";",offset);if(end==-1){end=document.cookie.length}cookieValue=document.cookie.substring(offset,end);if(typeof subName!="undefined"&&subName!=null&&subName!=""){var subCookies=cookieValue.toString().split("&");for(var j=0;j<subCookies.length;j++){var subCookie=subCookies[j];if(subCookie.substring(0,subName.length+1)==(subName+"=")){cookieValue=subCookie.substring(subName.length+1).replace(/%/g,"\\");break}else{cookieValue=""}}}}}return decodeURIComponent(cookieValue)},remove:function(name){this.write(name,"",-90)}},KgUrl:{getAck:(function(){var prot=location.protocol,host="//serveraddrweb.kugou.com/",scriptList=document.getElementsByTagName("script");
for(var i=0,l=scriptList.length,scriptUrl;i<l;i++){scriptUrl=scriptList[i].src||"";if(scriptUrl.indexOf(host)>-1&&scriptUrl.indexOf("KgAck")>-1){prot=(/^[^/]+/i).exec(scriptUrl)[0]}}return prot+host})()},getConfig:function(infoObj,callbackName,async){var this_domain=KgAck.GetDomain();if("kugou.com"!=this_domain&&"fanxing.com"!=this_domain){KgAck.GetMsg(callbackName,{errorCode:"20007",errorMsg:"forbidden"});return false}if(KgAck.IsEmpty(infoObj.appid)||KgAck.IsEmpty(infoObj.clientver)||KgAck.IsEmpty(infoObj.clienttime)||KgAck.IsEmpty(infoObj.plats)||KgAck.IsEmpty(callbackName)){KgAck.GetMsg(callbackName,{errorCode:"20010",errorMsg:"必填参数不能为空"});return false}var appid=parseInt(infoObj.appid);var clientver=parseInt(infoObj.clientver);var clienttime=parseInt(infoObj.clientver);var plats=infoObj.plats;if(appid<1||clientver<1||clienttime<1||!KgAck.IsArray(plats)||!KgAck.IsFunction(callbackName)){KgAck.GetMsg(callbackName,{errorCode:"20007",errorMsg:"非法请求,(请检查参数类型)"});return false}if(plats.length>30){KgAck.GetMsg(callbackName,{errorCode:"20007",errorMsg:"非法请求,(请求服务超出限制)"});return false}var plats_length=plats.length;var plats_tmp="";for(var i=0;i<plats_length;i++){plats_tmp=KgAck.Cookie.read("ACK_SERVER_"+plats[i]);if(plats_tmp!=null&&plats_tmp!=""){KgAck.GetMsg(callbackName,{errorCode:"20024",errorMsg:"存在缓存"});return false}}var plats_str=plats.toString();var async=false;if(async!=null&&async==true){async=true}var param={"appid":appid,"clientver":clientver,"plats":plats_str,"callback":callbackName,"clienttime":parseInt(new Date().getTime()/1000)};this.loadScript(KgAck.KgUrl.getAck,param,async)},GetDomain:function(){var s=/\w*\.(com.cn|com|net.cn|net|org.cn|org|gov.cn|gov|cn|mobi|me|info|name|biz|cc|tv|asia|hk|网络|公司|中国).*$/g;return document.domain.toString().match(s)[0]},GetMsg:function(callbackName,dataObj){if(!KgAck.IsEmpty(callbackName)){window[callbackName](dataObj)}},Trim:function(str){if(typeof str==="string"){return str.replace(/^\s+|\s+$/g,"")}else{return str}},IsEmpty:function(obj){if(typeof obj!="undefined"&&obj!=null&&obj!=""){return false}else{return true}},GetBytes:function(){var bytes=0;for(var i=0;i<this.length;i++){if(this.charCodeAt(i)>256){bytes+=2}else{bytes+=1}}return bytes},Intercept:function(length,appendStr){var str=this;str=str.trim();if(str.getBytes()<length){return str}var countLen=0;var charCount=0;if(appendStr.length>0){length=length-appendStr.length}for(var i=0;i<str.length;i++){if(this.charCodeAt(i)>256){countLen+=2}else{countLen+=1}if(countLen>length){break}charCount++}return str.substr(0,charCount)+appendStr},IsArray:function(value){if(typeof Array.isArray==="function"){return Array.isArray(value)}else{return Object.prototype.toString.call(value)==="[object Array]"}},IsFunction:function(funcName){try{if(typeof(eval(funcName))=="function"){return true}}catch(e){}return false}};